<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Creator aiOS 4.7 PRO - Multi-Lang</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&family=Inter:wght@300;400;600&family=JetBrains+Mono&display=swap');

        :root {
            --glass: rgba(10, 10, 20, 0.94);
            --glass-border: rgba(255, 255, 255, 0.1);
            --accent: #8b5cf6;
            --accent-glow: rgba(139, 92, 246, 0.5);
            --success: #10b981;
        }

        body, html {
            margin: 0; padding: 0;
            font-family: 'Inter', sans-serif;
            height: 100vh; width: 100vw;
            overflow: hidden; background: #010103; color: white;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(88, 28, 135, 0.2) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(30, 58, 138, 0.2) 0%, transparent 40%);
        }

        .brand { font-family: 'Orbitron', sans-serif; letter-spacing: 2px; }

        #desktop {
            position: relative; width: 100vw; height: 100vh;
            padding: 40px 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, 100px);
            grid-template-rows: repeat(auto-fill, 110px);
            grid-auto-flow: column;
            gap: 15px;
            z-index: 10;
        }

        .shortcut {
            display: flex; flex-direction: column; align-items: center; gap: 8px;
            cursor: pointer; transition: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 12px 5px; border-radius: 12px; border: 1px solid transparent;
            user-select: none;
        }
        .shortcut:hover { background: rgba(255,255,255,0.07); border-color: var(--glass-border); transform: translateY(-3px); }
        .shortcut-icon {
            width: 50px; height: 50px; display: flex; align-items: center; justify-content: center;
            font-size: 26px; border-radius: 14px; background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px); border: 1px solid var(--glass-border);
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
        }
        .shortcut-label { font-size: 10px; font-weight: 500; text-align: center; text-shadow: 0 2px 4px rgba(0,0,0,0.9); max-width: 90px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

        .window {
            position: absolute; background: var(--glass); backdrop-filter: blur(40px);
            border: 1px solid var(--glass-border); border-radius: 14px;
            display: none; flex-direction: column; z-index: 100;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.7);
            min-width: 320px; min-height: 200px;
            overflow: hidden;
        }
        .window-active { z-index: 300 !important; border-color: rgba(139, 92, 246, 0.4); box-shadow: 0 0 30px rgba(139, 92, 246, 0.2); }
        
        .window-header {
            height: 38px; background: rgba(255,255,255,0.04);
            display: flex; align-items: center; padding: 0 12px; cursor: move;
            justify-content: space-between; border-bottom: 1px solid var(--glass-border);
        }

        .control-btn { width: 12px; height: 12px; border-radius: 50%; cursor: pointer; transition: 0.2s; }
        .btn-close { background: #ff5f56; }

        .resizer {
            position: absolute; right: 0; bottom: 0; width: 15px; height: 15px;
            cursor: nwse-resize; z-index: 10; background: linear-gradient(135deg, transparent 70%, rgba(255,255,255,0.2) 100%);
        }

        .taskbar {
            position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%);
            background: rgba(15, 15, 25, 0.85); backdrop-filter: blur(25px);
            padding: 8px 15px; border-radius: 20px; border: 1px solid var(--glass-border);
            display: flex; gap: 12px; z-index: 1000; align-items: center;
        }

        .dock-item {
            width: 42px; height: 42px; border-radius: 10px; display: flex; 
            align-items: center; justify-content: center; font-size: 22px;
            cursor: pointer; transition: 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            background: rgba(255,255,255,0.03);
        }
        .dock-item:hover { transform: scale(1.2) translateY(-10px); background: var(--accent); }

        .lang-btn {
            background: rgba(255,255,255,0.1); padding: 2px 8px; border-radius: 6px;
            font-size: 10px; font-weight: bold; cursor: pointer; border: 1px solid rgba(255,255,255,0.1);
        }
        .lang-btn:hover { background: var(--accent); }

        .loader-dot { animation: pulse 1.5s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }

        #word-editor {
            width: 100%; height: 100%; padding: 25px; outline: none;
            background: transparent; color: #eee; font-size: 15px; line-height: 1.6;
        }
    </style>
</head>
<body>

    <div id="desktop">
        <!-- Shortcut Factory -->
        <div class="shortcut" onclick="openWin('factory')">
            <div class="shortcut-icon" style="border-color: var(--success); color: var(--success);">üõ†Ô∏è</div>
            <div class="shortcut-label" data-i18n="factory_label">App Factory</div>
        </div>
        <!-- Shortcut AI Word -->
        <div class="shortcut" onclick="openWin('word')">
            <div class="shortcut-icon" style="border-color: #3b82f6; color: #3b82f6;">üìù</div>
            <div class="shortcut-label" data-i18n="word_label">AI Word</div>
        </div>
        <!-- Shortcut Terminal -->
        <div class="shortcut" onclick="openWin('terminal')">
            <div class="shortcut-icon">üíª</div>
            <div class="shortcut-label" data-i18n="terminal_label">Terminal</div>
        </div>
    </div>

    <!-- Factory Window -->
    <div class="window" id="win-factory" style="width: 420px; height: 480px; top: 100px; left: 100px;">
        <div class="window-header">
            <span class="brand text-[9px] opacity-70" data-i18n="factory_title">App Factory v4.7</span>
            <div class="control-btn btn-close" onclick="closeWin('factory')"></div>
        </div>
        <div class="p-6 flex flex-col h-full bg-black/20">
            <h2 class="text-xl font-bold mb-1 text-emerald-400" data-i18n="factory_header">–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É</h2>
            <p class="text-[11px] opacity-40 mb-6 tracking-wider uppercase" data-i18n="factory_sub">AI GENERATION FOR YOUR DESKTOP</p>
            
            <div class="space-y-4 flex-grow">
                <div>
                    <label class="text-[10px] uppercase opacity-50 mb-1 block" data-i18n="field_name">–ù–∞–∑–≤–∞ –¥–æ–¥–∞—Ç–∫–∞</label>
                    <input type="text" id="app-name" placeholder="..." class="w-full bg-white/5 border border-white/10 rounded-lg p-3 outline-none focus:border-emerald-500 transition text-sm">
                </div>
                <div>
                    <label class="text-[10px] uppercase opacity-50 mb-1 block" data-i18n="field_desc">–û–ø–∏—Å —Ñ—É–Ω–∫—Ü—ñ–π</label>
                    <textarea id="app-desc" placeholder="..." class="w-full bg-white/5 border border-white/10 rounded-lg p-3 outline-none focus:border-emerald-500 transition text-sm h-32 resize-none"></textarea>
                </div>
            </div>

            <div class="mt-4 pt-4 border-t border-white/5">
                <button id="build-btn" onclick="buildApp()" class="w-full bg-emerald-600 hover:bg-emerald-500 py-3 rounded-xl font-bold text-xs uppercase tracking-widest transition active:scale-95" data-i18n="btn_build">
                    –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ ‚ú®
                </button>
                <div id="build-status" class="mt-3 text-[10px] font-mono text-emerald-500/80 text-center min-h-[1em]"></div>
            </div>
        </div>
        <div class="resizer"></div>
    </div>

    <!-- AI Word Window -->
    <div class="window" id="win-word" style="width: 700px; height: 550px; top: 80px; left: 150px;">
        <div class="window-header">
            <span class="brand text-[9px] opacity-70" data-i18n="word_title">AI Word Processor</span>
            <div class="control-btn btn-close" onclick="closeWin('word')"></div>
        </div>
        <div class="flex flex-col h-full">
            <div class="p-2 border-b border-white/10 bg-white/5 flex gap-2">
                <button onclick="aiTextTask('improve')" class="bg-blue-600/30 hover:bg-blue-600 text-[10px] px-3 py-1 rounded border border-blue-500/30 transition" data-i18n="btn_fix">–í–∏–ø—Ä–∞–≤–∏—Ç–∏ ‚ú®</button>
                <button onclick="aiTextTask('continue')" class="bg-purple-600/30 hover:bg-purple-600 text-[10px] px-3 py-1 rounded border border-purple-500/30 transition" data-i18n="btn_continue">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ ‚ú®</button>
                <div id="word-status" class="ml-auto text-[9px] flex items-center opacity-50" data-i18n="status_ready">–ì–æ—Ç–æ–≤–∏–π</div>
            </div>
            <div class="flex-grow overflow-auto">
                <div id="word-editor" contenteditable="true" data-i18n="word_placeholder">–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç —Ç—É—Ç...</div>
            </div>
        </div>
        <div class="resizer"></div>
    </div>

    <!-- Terminal Window -->
    <div class="window" id="win-terminal" style="width: 550px; height: 400px; top: 200px; left: 400px;">
        <div class="window-header">
            <span class="brand text-[9px] opacity-70" data-i18n="terminal_title">System Terminal</span>
            <div class="control-btn btn-close" onclick="closeWin('terminal')"></div>
        </div>
        <div class="flex flex-col h-full bg-black/80 font-mono text-xs text-emerald-500">
            <div id="term-body" class="p-4 flex-grow overflow-y-auto leading-relaxed">
                <div class="opacity-50">[aiOS 4.7 Kernel Loaded]</div>
                <div class="opacity-50">[Security: API Key Active]</div>
                <div class="opacity-50">[Status: AI Core Online]</div>
                <div class="mt-2 text-white" data-i18n="term_welcome">–í—ñ—Ç–∞—î–º–æ —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ. –í–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç.</div>
            </div>
            <div class="p-2 border-t border-white/10 flex">
                <span class="mr-2">ai_user@os:~$</span>
                <input type="text" id="term-input" class="bg-transparent outline-none flex-grow border-none text-white" onkeypress="if(event.key==='Enter') handleTermInput()">
            </div>
        </div>
        <div class="resizer"></div>
    </div>

    <!-- Taskbar -->
    <div class="taskbar">
        <div class="dock-item" onclick="openWin('factory')">üõ†Ô∏è</div>
        <div class="dock-item" onclick="openWin('word')">üìù</div>
        <div class="dock-item" onclick="openWin('terminal')">üíª</div>
        <div class="w-px h-6 bg-white/10 mx-1"></div>
        <div class="lang-btn" id="lang-switcher" onclick="toggleLanguage()">UA</div>
        <div id="clock" class="px-2 text-[11px] font-mono font-bold tracking-tighter opacity-80">00:00</div>
    </div>

    <script>
        const apiKey = "";
        
        // --- TRANSLATION DATA ---
        const i18n = {
            uk: {
                factory_label: "App Factory",
                word_label: "AI Word",
                terminal_label: "–¢–µ—Ä–º—ñ–Ω–∞–ª",
                factory_title: "App Factory v4.7",
                factory_header: "–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É",
                factory_sub: "AI –ì–ï–ù–ï–†–ê–¶–Ü–Ø –î–õ–Ø –í–ê–®–û–ì–û –°–¢–û–õ–ê",
                field_name: "–ù–∞–∑–≤–∞ –¥–æ–¥–∞—Ç–∫–∞",
                field_desc: "–û–ø–∏—Å —Ñ—É–Ω–∫—Ü—ñ–π",
                btn_build: "–ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ ‚ú®",
                word_title: "AI Word Processor",
                btn_fix: "–í–∏–ø—Ä–∞–≤–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ ‚ú®",
                btn_continue: "–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ —Ç–µ–∫—Å—Ç ‚ú®",
                status_ready: "–ì–æ—Ç–æ–≤–∏–π",
                status_thinking: "–î—É–º–∞—é...",
                word_placeholder: "–í–≤–µ–¥—ñ—Ç—å —Ç–µ–∫—Å—Ç —Ç—É—Ç... –®–Ü –¥–æ–ø–æ–º–æ–∂–µ –π–æ–≥–æ –ø–æ–∫—Ä–∞—â–∏—Ç–∏.",
                terminal_title: "–°–∏—Å—Ç–µ–º–Ω–∏–π –¢–µ—Ä–º—ñ–Ω–∞–ª",
                term_welcome: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ —ñ–Ω—Ç–µ–ª–µ–∫—Ç—É–∞–ª—å–Ω–∏–π —Ç–µ—Ä–º—ñ–Ω–∞–ª. –í–≤–µ–¥—ñ—Ç—å –ø–∏—Ç–∞–Ω–Ω—è.",
                gen_loading: "‚ö° –ì–ï–ù–ï–†–£–Æ –ö–û–î...",
                gen_success: "–í–°–¢–ê–ù–û–í–õ–ï–ù–û!",
                gen_error: "–ü–û–ú–ò–õ–ö–ê.",
                ai_sys_prompt: "–¢–∏ —è–¥—Ä–æ –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏ aiOS. –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é –ª–∞–∫–æ–Ω—ñ—á–Ω–æ."
            },
            en: {
                factory_label: "App Factory",
                word_label: "AI Word",
                terminal_label: "Terminal",
                factory_title: "App Factory v4.7",
                factory_header: "Create Application",
                factory_sub: "AI GENERATION FOR YOUR DESKTOP",
                field_name: "App Name",
                field_desc: "Function Description",
                btn_build: "Generate ‚ú®",
                word_title: "AI Word Processor",
                btn_fix: "Fix Errors ‚ú®",
                btn_continue: "Continue Text ‚ú®",
                status_ready: "Ready",
                status_thinking: "Thinking...",
                word_placeholder: "Type text here... AI will help you.",
                terminal_title: "System Terminal",
                term_welcome: "Welcome to intelligent terminal. Enter any query.",
                gen_loading: "‚ö° GENERATING CODE...",
                gen_success: "INSTALLED!",
                gen_error: "ERROR.",
                ai_sys_prompt: "You are the aiOS core. Answer in English concisely."
            },
            ru: {
                factory_label: "App Factory",
                word_label: "AI Word",
                terminal_label: "–¢–µ—Ä–º–∏–Ω–∞–ª",
                factory_title: "App Factory v4.7",
                factory_header: "–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É",
                factory_sub: "AI –ì–ï–ù–ï–†–ê–¶–ò–Ø –î–õ–Ø –í–ê–®–ï–ì–û –°–¢–û–õ–ê",
                field_name: "–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
                field_desc: "–û–ø–∏—Å–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π",
                btn_build: "–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å ‚ú®",
                word_title: "AI Word Processor",
                btn_fix: "–ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ ‚ú®",
                btn_continue: "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚ú®",
                status_ready: "–ì–æ—Ç–æ–≤",
                status_thinking: "–î—É–º–∞—é...",
                word_placeholder: "–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∑–¥–µ—Å—å... –ò–ò –ø–æ–º–æ–∂–µ—Ç –µ–≥–æ —É–ª—É—á—à–∏—Ç—å.",
                terminal_title: "–°–∏—Å—Ç–µ–º–Ω—ã–π –¢–µ—Ä–º–∏–Ω–∞–ª",
                term_welcome: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω—ã–π —Ç–µ—Ä–º–∏–Ω–∞–ª. –í–≤–µ–¥–∏—Ç–µ –ª—é–±–æ–π –≤–æ–ø—Ä–æ—Å.",
                gen_loading: "‚ö° –ì–ï–ù–ï–†–ò–†–£–Æ –ö–û–î...",
                gen_success: "–£–°–¢–ê–ù–û–í–õ–ï–ù–û!",
                gen_error: "–û–®–ò–ë–ö–ê.",
                ai_sys_prompt: "–¢—ã —è–¥—Ä–æ –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã aiOS. –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ –ª–∞–∫–æ–Ω–∏—á–Ω–æ."
            }
        };

        let currentLang = 'uk';

        function toggleLanguage() {
            const langs = ['uk', 'en', 'ru'];
            let idx = langs.indexOf(currentLang);
            currentLang = langs[(idx + 1) % langs.length];
            document.getElementById('lang-switcher').innerText = currentLang.toUpperCase();
            applyLanguage();
            logToTerminal(`System: Language changed to ${currentLang.toUpperCase()}`);
        }

        function applyLanguage() {
            const langData = i18n[currentLang];
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (langData[key]) {
                    if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') {
                        el.placeholder = langData[key];
                    } else {
                        el.innerText = langData[key];
                    }
                }
            });
        }

        // --- CORE AI HANDLER ---
        async function askAI(prompt, systemPrompt = "") {
            const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const sys = systemPrompt || i18n[currentLang].ai_sys_prompt;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
                systemInstruction: { parts: [{ text: sys }] }
            };

            const backoff = [1000, 2000, 4000];
            for(let i = 0; i < 3; i++) {
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(payload)
                    });
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || null;
                } catch (e) {
                    await new Promise(r => setTimeout(r, backoff[i]));
                }
            }
            return null;
        }

        // --- APP FACTORY ---
        async function buildApp() {
            const name = document.getElementById('app-name').value.trim();
            const desc = document.getElementById('app-desc').value.trim();
            const btn = document.getElementById('build-btn');
            const status = document.getElementById('build-status');
            const lang = i18n[currentLang];

            if(!name || !desc) return;

            btn.disabled = true;
            status.innerText = lang.gen_loading;
            logToTerminal(`System: Generating app "${name}"...`);

            const code = await askAI(
                `Build a standalone web app: "${name}". Features: ${desc}. Interface Language: ${currentLang}. Use Tailwind CSS. Return ONLY HTML.`,
                "You are an expert web developer. No markdown symbols."
            );

            if(code) {
                installApp(name, code);
                status.innerText = lang.gen_success;
                logToTerminal(`System: App "${name}" ready.`);
            } else {
                status.innerText = lang.gen_error;
            }

            setTimeout(() => { status.innerText = ""; btn.disabled = false; }, 3000);
        }

        function installApp(name, code) {
            const appId = 'app_' + Date.now();
            const icon = document.createElement('div');
            icon.className = 'shortcut';
            icon.onclick = () => openWin(appId);
            icon.innerHTML = `<div class="shortcut-icon" style="background:rgba(139,92,246,0.1); border-color:rgba(139,92,246,0.3);">üì¶</div><div class="shortcut-label">${name}</div>`;
            document.getElementById('desktop').appendChild(icon);

            const win = document.createElement('div');
            win.id = 'win-' + appId;
            win.className = 'window';
            win.style.cssText = `width:600px; height:500px; top:150px; left:150px;`;
            win.innerHTML = `
                <div class="window-header"><span class="brand text-[9px] opacity-70">${name.toUpperCase()}</span><div class="control-btn btn-close" onclick="closeWin('${appId}')"></div></div>
                <div class="flex-grow bg-white"><iframe id="iframe-${appId}" style="width:100%; height:100%; border:none;"></iframe></div>
                <div class="resizer"></div>
            `;
            document.body.appendChild(win);
            
            const doc = document.getElementById('iframe-' + appId).contentWindow.document;
            doc.open(); doc.write(code.replace(/```html|```/g, "").trim()); doc.close();
            initWinActions(win);
            openWin(appId);
        }

        // --- AI WORD ---
        async function aiTextTask(type) {
            const editor = document.getElementById('word-editor');
            const status = document.getElementById('word-status');
            const lang = i18n[currentLang];
            const content = editor.innerText;
            if(content.length < 5) return;

            status.innerText = lang.status_thinking;
            
            const prompts = {
                improve: `–ò—Å–ø—Ä–∞–≤—å –æ—à–∏–±–∫–∏ –≤ —Ç–µ–∫—Å—Ç–µ: "${content}". –Ø–∑—ã–∫: ${currentLang}`,
                continue: `–ü—Ä–æ–¥–æ–ª–∂–∏ —Ç–µ–∫—Å—Ç (2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è): "${content}". –Ø–∑—ã–∫: ${currentLang}`
            };

            const result = await askAI(prompts[type], "Return ONLY the text result.");
            
            if(result) {
                if(type === 'improve') editor.innerText = result.trim();
                else editor.innerText += " " + result.trim();
                status.innerText = "‚ú®";
            } else {
                status.innerText = "Error";
            }
            setTimeout(() => status.innerText = lang.status_ready, 2000);
        }

        // --- TERMINAL ---
        async function handleTermInput() {
            const input = document.getElementById('term-input');
            const body = document.getElementById('term-body');
            const cmd = input.value.trim();
            if(!cmd) return;

            body.innerHTML += `<div class="text-white mt-1">> ${cmd}</div>`;
            input.value = "";
            body.scrollTop = body.scrollHeight;

            if(cmd.toLowerCase() === 'clear') { body.innerHTML = ""; return; }

            const loading = document.createElement('div');
            loading.className = "opacity-50 animate-pulse";
            loading.innerText = "[AI Core processing...]";
            body.appendChild(loading);

            const response = await askAI(cmd);
            
            loading.remove();
            body.innerHTML += `<div class="text-emerald-300 mt-1">${response || "No response."}</div>`;
            body.scrollTop = body.scrollHeight;
        }

        // --- WIN SYSTEM ---
        function openWin(id) {
            const win = document.getElementById('win-' + id);
            if(win) { win.style.display = 'flex'; focusWin(win); }
        }
        function closeWin(id) { 
            const win = document.getElementById('win-' + id);
            if(win) win.style.display = 'none'; 
        }
        function focusWin(win) {
            document.querySelectorAll('.window').forEach(w => w.classList.remove('window-active'));
            win.classList.add('window-active');
        }

        function initWinActions(win) {
            const header = win.querySelector('.window-header');
            const resizer = win.querySelector('.resizer');
            header.onmousedown = (e) => {
                if(e.target.classList.contains('control-btn')) return;
                focusWin(win);
                let ox = e.clientX - win.offsetLeft, oy = e.clientY - win.offsetTop;
                document.onmousemove = (ev) => { win.style.left = ev.clientX - ox + 'px'; win.style.top = ev.clientY - oy + 'px'; };
                document.onmouseup = () => document.onmousemove = null;
            };
            resizer.onmousedown = (e) => {
                e.preventDefault();
                let sw = win.offsetWidth, sh = win.offsetHeight, sx = e.clientX, sy = e.clientY;
                document.onmousemove = (ev) => { win.style.width = Math.max(300, sw + (ev.clientX - sx)) + 'px'; win.style.height = Math.max(200, sh + (ev.clientY - sy)) + 'px'; };
                document.onmouseup = () => document.onmousemove = null;
            };
            win.onmousedown = () => focusWin(win);
        }

        function logToTerminal(msg) {
            const body = document.getElementById('term-body');
            if(body) {
                body.innerHTML += `<div class="opacity-50 mt-1">[${new Date().toLocaleTimeString()}] ${msg}</div>`;
                body.scrollTop = body.scrollHeight;
            }
        }

        document.querySelectorAll('.window').forEach(initWinActions);
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'});
        }, 1000);
        
        applyLanguage();
    </script>
</body>
</html>
